# å®æ—¶ç›´æ’­æ£€æµ‹åŠŸèƒ½å¼€å‘è®¡åˆ’

> çŠ¶æ€: ğŸ“‹ è®¡åˆ’ä¸­ | ä¼˜å…ˆçº§: é«˜ | é¢„è®¡å·¥ä½œé‡: 2-3 å°æ—¶

## æ¦‚è¿°

ä¸ºç«™ç‚¹æ·»åŠ å®æ—¶ç›´æ’­çŠ¶æ€æ£€æµ‹åŠŸèƒ½ï¼Œè®©ç”¨æˆ·è®¿é—®æ—¶èƒ½ç«‹å³çœ‹åˆ°å½“å‰æ˜¯å¦åœ¨ç›´æ’­ï¼Œè€Œä¸æ˜¯ä¾èµ–æ¯å¤©ä¸€æ¬¡çš„é™æ€æ•°æ®æ›´æ–°ã€‚

## ç›®æ ‡

- [ ] å®ç°å®¢æˆ·ç«¯å®æ—¶æ£€æµ‹ Bilibili ç›´æ’­çŠ¶æ€
- [ ] æ¯ 15 åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ï¼ˆå¹³è¡¡å®æ—¶æ€§ä¸æœåŠ¡å™¨å‹åŠ›ï¼‰
- [ ] æ— éœ€å­˜å‚¨å†å²æ•°æ®æˆ–é€šçŸ¥åŠŸèƒ½ï¼ˆä¿æŒç®€å•ï¼‰
- [ ] ä¸ç°æœ‰è®¾è®¡ç³»ç»Ÿé£æ ¼ä¸€è‡´

## æŠ€æœ¯æ–¹æ¡ˆ

### æ¶æ„å›¾

```
ç”¨æˆ·æµè§ˆå™¨                    Cloudflare Pages              Bilibili API
    â”‚                              â”‚                              â”‚
    â”‚  1. è®¿é—®é¡µé¢                 â”‚                              â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                              â”‚
    â”‚                              â”‚                              â”‚
    â”‚  2. åŠ è½½é¡µé¢ + React ç»„ä»¶    â”‚                              â”‚
    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                              â”‚
    â”‚                              â”‚                              â”‚
    â”‚  3. è°ƒç”¨ /api/live           â”‚                              â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                              â”‚
    â”‚                              â”‚  4. æ£€æŸ¥ç¼“å­˜                 â”‚
    â”‚                              â”‚  â”œâ”€â”€ æœ‰ç¼“å­˜ (15åˆ†é’Ÿå†…)? â”€â”€> è¿”å›ç¼“å­˜
    â”‚                              â”‚  â””â”€â”€ æ— ç¼“å­˜?               â”‚
    â”‚                              â”‚       â”‚                    â”‚
    â”‚                              â”‚       â–¼                    â”‚
    â”‚                              â”‚  5. è¯·æ±‚ Bilibili API     â”‚
    â”‚                              â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚                              â”‚                              â”‚
    â”‚                              â”‚  6. è¿”å›ç›´æ’­æ•°æ®            â”‚
    â”‚                              â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
    â”‚                              â”‚                              â”‚
    â”‚                              â”‚  7. æ›´æ–°ç¼“å­˜               â”‚
    â”‚                              â”‚                              â”‚
    â”‚  8. è¿”å›ç®€åŒ–æ•°æ®             â”‚                              â”‚
    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                              â”‚
    â”‚                              â”‚                              â”‚
    â”‚  9. æ¸²æŸ“ç›´æ’­çŠ¶æ€ UI          â”‚                              â”‚
    â”‚  (ğŸ”´ ç›´æ’­ä¸­ / âšª æœªå¼€æ’­)      â”‚                              â”‚
    â”‚                              â”‚                              â”‚
    â”‚  10. 15åˆ†é’Ÿåè‡ªåŠ¨åˆ·æ–°        â”‚                              â”‚
    â”‚  (é‡å¤æ­¥éª¤ 3-9)              â”‚                              â”‚
    â”‚                              â”‚                              â”‚
```

### æŠ€æœ¯æ ˆï¼ˆä»ç°æœ‰æ¸…å•ä¸­é€‰æ‹©ï¼‰

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| å‰ç«¯æ¡†æ¶ | React | ^18.x | äº¤äº’ç»„ä»¶ï¼ˆAstro å²›å±¿ï¼‰ |
| çŠ¶æ€ç®¡ç† | useState/useEffect | - | ç»„ä»¶å†…éƒ¨çŠ¶æ€ |
| åç«¯æ¡†æ¶ | Hono | ^4.x | è¾¹ç¼˜å‡½æ•° API |
| è¿è¡Œæ—¶ | Node.js (Cloudflare) | - | è¾¹ç¼˜å‡½æ•°æ‰§è¡Œ |
| éƒ¨ç½²å¹³å° | Cloudflare Pages Functions | - | è¾¹ç¼˜è®¡ç®— |

### æ–‡ä»¶æ”¹åŠ¨è®¡åˆ’

```
project-root/
â”œâ”€â”€ functions/                    # â† æ–°å»ºç›®å½•
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ live.ts              # â† æ–°å¢: è¾¹ç¼˜å‡½æ•° API
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Hero.astro           # â† ä¿®æ”¹: æ·»åŠ  LiveStatus ç»„ä»¶å¼•ç”¨
â”‚   â”‚   â””â”€â”€ LiveStatus.tsx       # â† æ–°å¢: å®æ—¶ç›´æ’­çŠ¶æ€ç»„ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ astro.config.mjs             # â† ä¿®æ”¹: æ·»åŠ  React é›†æˆï¼ˆå¦‚æœªé…ç½®ï¼‰
â””â”€â”€ package.json                 # â† ä¿®æ”¹: æ·»åŠ  React/Hono ä¾èµ–
```

### API è®¾è®¡

**ç«¯ç‚¹**: `GET /api/live`

**å“åº”æ ¼å¼**:
```typescript
interface LiveStatusResponse {
  isLive: boolean;           // æ˜¯å¦ç›´æ’­ä¸­
  title: string;             // ç›´æ’­æ ‡é¢˜ï¼ˆç¦»çº¿æ—¶ä¸ºç©ºï¼‰
  url: string;               // ç›´æ’­é—´é“¾æ¥ï¼ˆç¦»çº¿æ—¶ä¸ºç©ºï¼‰
  roomId: string;            // æˆ¿é—´å·
  lastChecked: string;       // ISO 8601 æ—¶é—´æˆ³
}
```

**ç¤ºä¾‹å“åº”ï¼ˆç›´æ’­ä¸­ï¼‰**:
```json
{
  "isLive": true,
  "title": "ã€ä¸œçˆ±ç’ƒã€‘ä»Šæ™šæ˜¯æ­Œå›ï¼",
  "url": "https://live.bilibili.com/xxx",
  "roomId": "xxx",
  "lastChecked": "2026-02-06T10:30:00.000Z"
}
```

**ç¤ºä¾‹å“åº”ï¼ˆæœªå¼€æ’­ï¼‰**:
```json
{
  "isLive": false,
  "title": "",
  "url": "",
  "roomId": "xxx",
  "lastChecked": "2026-02-06T10:30:00.000Z"
}
```

**HTTP Headers**:
```
Cache-Control: public, max-age=900  // 15 åˆ†é’Ÿç¼“å­˜
Content-Type: application/json
```

### ç»„ä»¶è®¾è®¡

**ç»„ä»¶å**: `LiveStatus.tsx`

**Props æ¥å£**:
```typescript
interface LiveStatusProps {
  // ç›®å‰æ—  propsï¼Œå®Œå…¨è‡ªä¸»è·å–æ•°æ®
  // æœªæ¥å¯æ‰©å±•: pollingInterval, onStatusChange ç­‰
}
```

**çŠ¶æ€æœº**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     åŠ è½½ä¸­      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  initial â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ loading  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                   â”‚                   â”‚
            â–¼                   â–¼                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   live   â”‚        â”‚ offline  â”‚       â”‚  error   â”‚
      â”‚ ğŸ”´ç›´æ’­ä¸­ â”‚        â”‚ âšªæœªå¼€æ’­ â”‚       â”‚ âš ï¸é”™è¯¯  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                   â”‚                   â”‚
            â”‚  15åˆ†é’Ÿåè‡ªåŠ¨åˆ·æ–°  â”‚                   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**UI çŠ¶æ€**:

| çŠ¶æ€ | æ˜¾ç¤º | æ ·å¼ |
|------|------|------|
| loading | "æ£€æµ‹ä¸­..." | è„‰å†²åŠ¨ç”» |
| live | ğŸ”´ ç›´æ’­ä¸­ + ç›´æ’­é—´é“¾æ¥ | çº¢è‰²æ¸å˜ pill |
| offline | âšª æœªå¼€æ’­ | ç°è‰²æ–‡å­— |
| error | âš ï¸ æ£€æµ‹å¤±è´¥ | çº¢è‰²æ–‡å­— |

### æ ·å¼è§„èŒƒ

ä½¿ç”¨ç°æœ‰ design-system.css çš„é…è‰²:

```css
/* ç›´æ’­ä¸­ - ä½¿ç”¨ç°æœ‰ç´«è‰²æ¸å˜ */
.live-pill {
  background: linear-gradient(135deg, var(--purple-500), var(--purple-700));
  /* å…¶ä»–æ ·å¼ä¸ .social-pill ä¿æŒä¸€è‡´ */
}

/* æœªå¼€æ’­ - ä½¿ç”¨æ£•è‰²ç³» */
.offline-text {
  color: var(--brown-400);
}

/* å®¹å™¨ */
.live-status-container {
  /* ä¸ .main-socials ä¿æŒä¸€è‡´ */
  margin: 15px 0;
}
```

## å®æ–½æ­¥éª¤

### é˜¶æ®µ 1: ç¯å¢ƒå‡†å¤‡

- [ ] 1.1 å®‰è£…ä¾èµ–
  ```bash
  npm install @astrojs/react react react-dom hono
  ```

- [ ] 1.2 é…ç½® React é›†æˆ
  - ä¿®æ”¹ `astro.config.mjs`
  - æ·»åŠ  `@astrojs/react()` åˆ° integrations

- [ ] 1.3 åˆ›å»º functions ç›®å½•ç»“æ„
  ```bash
  mkdir -p functions/api
  ```

**é¢„è®¡æ—¶é—´**: 10 åˆ†é’Ÿ

### é˜¶æ®µ 2: åç«¯å®ç°

- [ ] 2.1 åˆ›å»º `functions/api/live.ts`
  - ä½¿ç”¨ Hono æ¡†æ¶
  - ä»£ç† Bilibili API
  - å®ç° 15 åˆ†é’Ÿç¼“å­˜
  - é”™è¯¯å¤„ç†

- [ ] 2.2 æœ¬åœ°æµ‹è¯•è¾¹ç¼˜å‡½æ•°
  ```bash
  npm run dev
  # è®¿é—® http://localhost:4321/api/live
  ```

**é¢„è®¡æ—¶é—´**: 30 åˆ†é’Ÿ

### é˜¶æ®µ 3: å‰ç«¯å®ç°

- [ ] 3.1 åˆ›å»º `src/components/LiveStatus.tsx`
  - React å‡½æ•°ç»„ä»¶
  - useEffect åˆå§‹åŒ–æ•°æ®è·å–
  - setInterval 15 åˆ†é’Ÿè½®è¯¢
  - çŠ¶æ€æ¸²æŸ“é€»è¾‘

- [ ] 3.2 ç¼–å†™ç»„ä»¶æ ·å¼
  - ä½¿ç”¨ CSS-in-JS (styled-jsx æˆ–å†…è”æ ·å¼)
  - ä¿æŒä¸ design-system.css ä¸€è‡´
  - å“åº”å¼è®¾è®¡

- [ ] 3.3 æœ¬åœ°æµ‹è¯•ç»„ä»¶
  - æ£€æŸ¥å„ç§çŠ¶æ€æ˜¾ç¤º
  - éªŒè¯è½®è¯¢é€»è¾‘
  - æµ‹è¯•é”™è¯¯å¤„ç†

**é¢„è®¡æ—¶é—´**: 45 åˆ†é’Ÿ

### é˜¶æ®µ 4: é›†æˆ

- [ ] 4.1 ä¿®æ”¹ `src/components/Hero.astro`
  - å¯¼å…¥ LiveStatus ç»„ä»¶
  - åœ¨ç²‰ä¸æ•°ä¸‹æ–¹æ·»åŠ æ¡ä»¶æ¸²æŸ“

- [ ] 4.2 é…ç½® `config.showLiveStatus`
  - ç¡®ä¿ `src/data/site-data.json` ä¸­ `showLiveStatus: true`

- [ ] 4.3 æ•´ä½“æµ‹è¯•
  - æœ¬åœ°å¼€å‘ç¯å¢ƒéªŒè¯
  - æ£€æŸ¥æ§åˆ¶å°é”™è¯¯
  - éªŒè¯æ ·å¼ä¸€è‡´æ€§

**é¢„è®¡æ—¶é—´**: 20 åˆ†é’Ÿ

### é˜¶æ®µ 5: éƒ¨ç½²éªŒè¯

- [ ] 5.1 æäº¤ä»£ç 
  ```bash
  git add .
  git commit -m "feat: æ·»åŠ å®æ—¶ç›´æ’­çŠ¶æ€æ£€æµ‹åŠŸèƒ½"
  git push
  ```

- [ ] 5.2 ç­‰å¾… Cloudflare Pages éƒ¨ç½²

- [ ] 5.3 ç”Ÿäº§ç¯å¢ƒéªŒè¯
  - è®¿é—®ç«™ç‚¹æ£€æŸ¥ç›´æ’­çŠ¶æ€æ˜¾ç¤º
  - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·éªŒè¯ API è°ƒç”¨
  - ç¡®è®¤ç¼“å­˜ç­–ç•¥ç”Ÿæ•ˆ

**é¢„è®¡æ—¶é—´**: 15 åˆ†é’Ÿ

## æ€§èƒ½æŒ‡æ ‡

### ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰å€¼ |
|------|--------|--------|
| é¦–æ¬¡æ•°æ®åŠ è½½ | < 500ms | N/A |
| ç»„ä»¶ JS ä½“ç§¯ | < 5KB | N/A |
| API å“åº”æ—¶é—´ | < 200ms | N/A |
| å†…å­˜å ç”¨ | < 10MB | N/A |

### ç›‘æ§

- [ ] æ·»åŠ ç®€å•æ—¥å¿—ï¼ˆå¯é€‰ï¼‰
  ```typescript
  console.log('[LiveStatus] API call at:', new Date().toISOString())
  ```

- [ ] Cloudflare Analyticsï¼ˆè‡ªåŠ¨ï¼‰
  - æŸ¥çœ‹ Functions è°ƒç”¨æ¬¡æ•°
  - ç›‘æ§é”™è¯¯ç‡

## é£é™©ä¸ç¼“è§£

| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ |
|------|--------|------|----------|
| Bilibili API å˜æ›´ | ä¸­ | é«˜ | æ·»åŠ é”™è¯¯å¤„ç†ï¼Œä¼˜é›…é™çº§ |
| Cloudflare å…è´¹é¢åº¦è¶…é™ | ä½ | ä¸­ | 15 åˆ†é’Ÿç¼“å­˜ç­–ç•¥ |
| React é›†æˆå¯¼è‡´æ„å»ºå¤±è´¥ | ä½ | ä¸­ | æœ¬åœ°å……åˆ†æµ‹è¯•åå†éƒ¨ç½² |
| ç»„ä»¶æ ·å¼å†²çª | ä¸­ | ä½ | ä½¿ç”¨ scoped CSS |

## åç»­ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

### çŸ­æœŸï¼ˆå½“å‰è¿­ä»£åï¼‰
- [ ] æ·»åŠ åŠ è½½éª¨æ¶å±
- [ ] ä¼˜åŒ–é”™è¯¯æç¤ºæ–‡æ¡ˆ
- [ ] æ·»åŠ æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®

### ä¸­æœŸï¼ˆæœªæ¥ 1-2 å‘¨ï¼‰
- [ ] ä½¿ç”¨ IndexedDB ç¼“å­˜ä¸Šæ¬¡çŠ¶æ€ï¼ˆæå‡æ„ŸçŸ¥é€Ÿåº¦ï¼‰
- [ ] æ·»åŠ å¼€æ’­/ä¸‹æ’­æ—¶é—´ç»Ÿè®¡
- [ ] æœåŠ¡ç«¯æ¨é€ï¼ˆServer-Sent Eventsï¼‰æ›¿ä»£è½®è¯¢

### é•¿æœŸï¼ˆæœªæ¥ 1-2 æœˆï¼‰
- [ ] æµè§ˆå™¨é€šçŸ¥åŠŸèƒ½
- [ ] å†å²ç›´æ’­è®°å½•ç»Ÿè®¡
- [ ] ç›´æ’­æ—¶é•¿å›¾è¡¨å¯è§†åŒ–

## å‚è€ƒèµ„æ–™

- [Astro React é›†æˆæ–‡æ¡£](https://docs.astro.build/en/guides/integrations-guide/react/)
- [Hono æ–‡æ¡£](https://hono.dev/)
- [Cloudflare Pages Functions](https://developers.cloudflare.com/pages/functions/)
- [Bilibili API æ–‡æ¡£ï¼ˆéå®˜æ–¹ï¼‰](https://github.com/SocialSisterYi/bilibili-API-collect)

## å†³ç­–è®°å½•

### 2026-02-06: æŠ€æœ¯é€‰å‹å†³ç­–

**å†³ç­–**: ä½¿ç”¨ Hono + React + Cloudflare Functions

**ç†ç”±**:
1. Hono è½»é‡ï¼Œä¸ Cloudflare é›†æˆå¥½
2. React æ˜¯ç°æœ‰æŠ€æœ¯æ ˆçš„ä¸€éƒ¨åˆ†
3. æ— éœ€å¼•å…¥é¢å¤–æ•°æ®åº“ï¼ˆRedis/Gel/PostgreSQL ç­‰ï¼‰
4. 15 åˆ†é’Ÿè½®è¯¢é¢‘ç‡å¹³è¡¡å®æ—¶æ€§å’ŒæœåŠ¡å™¨å‹åŠ›

**æ›¿ä»£æ–¹æ¡ˆ**:
- âŒ çº¯å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ Bilibili APIï¼ˆè·¨åŸŸé—®é¢˜ï¼‰
- âŒ ä½¿ç”¨ Next.js API Routesï¼ˆéœ€è¦è¿ç§»æ¡†æ¶ï¼Œæ”¹åŠ¨å¤ªå¤§ï¼‰
- âŒ ä½¿ç”¨ Upstash Redisï¼ˆè¿‡åº¦è®¾è®¡ï¼Œæ— éœ€æŒä¹…åŒ–ï¼‰

---

**æ–‡æ¡£ç»´æŠ¤è€…**: @yourname  
**æœ€åæ›´æ–°**: 2026-02-06  
**ç‰ˆæœ¬**: 1.0
